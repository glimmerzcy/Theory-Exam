{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\src\\\\pages\\\\Exam\\\\Exam.jsx\",\n    _class,\n    _class2,\n    _class4,\n    _class6,\n    _class8;\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Prompt, StaticRouter } from 'react-router';\nimport Time from '../../utils/Time';\nimport MathCAPTCHA from '../../utils/MathCAPTCHA/MathCAPTCHA';\nimport Route from '../../config/RouteConfig';\nimport Store from '../../utils/Store';\nimport './Exam.css';\nimport RouteConfig from '../../config/RouteConfig';\nimport cookieManage from '../../utils/cookieManage';\nvar setQuizNavigator, getQuizUndo;\nvar isDrag = false;\nvar currentY = 0;\n\nvar buildTimeCount = function buildTimeCount(milliseconds) {\n  var second = Math.floor(milliseconds % 60000 / 1000);\n  var hour = Math.floor(milliseconds / 3600000);\n  var minute = Math.floor(milliseconds % 3600000 / 60000);\n  var mill = milliseconds - 60000 * minute - 1000 * second - 3600000 * hour;\n  mill = ('' + mill).substr(0, 3);\n  return [hour, minute, second, mill];\n};\n\nexport var submitAnswer =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee() {\n    var func, result;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return window.showLoading();\n\n          case 3:\n            _context.next = 5;\n            return window.showToast('提交答案中，请不要刷新.....', 1000);\n\n          case 5:\n            _context.next = 7;\n            return Store.request('exam/submit')();\n\n          case 7:\n            func = _context.sent;\n            _context.next = 10;\n            return func();\n\n          case 10:\n            _context.next = 21;\n            break;\n\n          case 12:\n            _context.prev = 12;\n            _context.t0 = _context[\"catch\"](0);\n            _context.next = 16;\n            return window.hideLoading();\n\n          case 16:\n            result = Store.infoList.exam_paper.submit();\n            cookieManage.deleteStoreCookie();\n            cookieManage.storeCookie(result);\n            _context.next = 21;\n            return window.showModal({\n              view: React.createElement(React.Fragment, null, React.createElement(\"h4\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 48\n                },\n                __self: this\n              }, _context.t0.toString()), React.createElement(\"p\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 49\n                },\n                __self: this\n              }, \"\\u8BF7\\u786E\\u4FDD\\u7F51\\u7EDC\\u8FDE\\u63A5\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u91CD\\u65B0\\u63D0\\u4EA4\"), React.createElement(\"p\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 50\n                },\n                __self: this\n              }, \"\\u5DF2\\u7ECF\\u5C06\\u672C\\u6B21\\u4F5C\\u7B54\\u8BB0\\u5F55\\u50A8\\u5B58\\u5728\\u672C\\u5730\\uFF0C\\u5C06\\u4F1A\\u5728\\u4E0B\\u6B21\\u60A8\\u6253\\u5F00\\u9996\\u9875\\u7684\\u65F6\\u5019\\u81EA\\u52A8\\u4E3A\\u60A8\\u63D0\\u4EA4\"))\n            });\n\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this, [[0, 12]]);\n  }));\n\n  return function submitAnswer() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar Timer = observer(_class =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Timer, _React$Component);\n\n  function Timer(props) {\n    var _this;\n\n    _classCallCheck(this, Timer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Timer).call(this, props));\n    _this.state = {\n      time: Store.infoList.exam_paper.head\n    };\n    return _this;\n  }\n\n  _createClass(Timer, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.setState({\n        time: 'launching……'\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var _this2 = this;\n\n        var duration, foo, interval;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return Time.sleep(3000);\n\n              case 2:\n                duration = Store.infoList.exam_paper.head.duration;\n\n                foo = function foo(duration, step) {\n                  return setInterval(function () {\n                    var _buildTimeCount = buildTimeCount(duration),\n                        _buildTimeCount2 = _slicedToArray(_buildTimeCount, 4),\n                        hour = _buildTimeCount2[0],\n                        minute = _buildTimeCount2[1],\n                        second = _buildTimeCount2[2],\n                        mill = _buildTimeCount2[3];\n\n                    _this2.setState({\n                      time: [hour, minute, second].map(function (ele) {\n                        return ele < 10 ? '0' + ele : ele;\n                      }).join(': ') + '.' + mill\n                    });\n\n                    hour === 0 && minute === 5 && second === 0 && window.showModal({\n                      view: React.createElement(React.Fragment, null, React.createElement(\"h2\", {\n                        __source: {\n                          fileName: _jsxFileName,\n                          lineNumber: 82\n                        },\n                        __self: this\n                      }, \"\\u6E29\\u99A8\\u63D0\\u793A\"), React.createElement(\"p\", {\n                        __source: {\n                          fileName: _jsxFileName,\n                          lineNumber: 83\n                        },\n                        __self: this\n                      }, \"\\u8003\\u8BD5\\u65F6\\u95F4\\u4E0D\\u8DB35\\u5206\\u949F\"), React.createElement(\"p\", {\n                        __source: {\n                          fileName: _jsxFileName,\n                          lineNumber: 84\n                        },\n                        __self: this\n                      }, \"\\u8BF7\\u6CE8\\u610F\\uFF01\"))\n                    });\n\n                    if (duration <= 0) {\n                      clearInterval(_this2.state.interval);\n\n                      _this2.setState({\n                        time: \"time's up\"\n                      });\n\n                      var onConfirm = function onConfirm() {\n                        return promptOFF(\n                        /*#__PURE__*/\n                        _asyncToGenerator(\n                        /*#__PURE__*/\n                        _regeneratorRuntime.mark(function _callee2() {\n                          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                            while (1) {\n                              switch (_context2.prev = _context2.next) {\n                                case 0:\n                                  _context2.next = 2;\n                                  return submitAnswer();\n\n                                case 2:\n                                  Store.infoList.exam_paper.head.duration = 5;\n\n                                case 3:\n                                case \"end\":\n                                  return _context2.stop();\n                              }\n                            }\n                          }, _callee2);\n                        })));\n                      };\n\n                      window.showModal({\n                        view: React.createElement(\"h2\", {\n                          __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 95\n                          },\n                          __self: this\n                        }, \"\\u65F6\\u95F4\\u5230\\uFF01\"),\n                        onConfirm: onConfirm,\n                        confirmText: '立即交卷',\n                        cancelText: '放弃本次考试',\n                        onCancel: function onCancel() {\n                          return promptOFF(function () {\n                            window.navigateBack();\n                            window.showToast('已放弃考试！欢迎再战！', 1500, function () {\n                              return window.navigateTo(Route.Student.route);\n                            });\n                          });\n                        }\n                      });\n                    }\n\n                    duration -= step;\n                  }, step);\n                };\n\n                interval = foo(duration * 60000, 50);\n                this.setState({\n                  interval: interval\n                });\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.state.interval);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, this.state.time);\n    }\n  }]);\n\n  return Timer;\n}(React.Component)) || _class;\n\nvar QuizNavigator = observer(_class2 =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(QuizNavigator, _React$Component2);\n\n  function QuizNavigator(props) {\n    var _this3;\n\n    _classCallCheck(this, QuizNavigator);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(QuizNavigator).call(this, props));\n\n    _this3.componentWillMount = function () {\n      _this3.setState({\n        array: new Array(_this3.props.num).fill(0)\n      });\n    };\n\n    _this3.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _this3.setState({\n                isShow: true\n              });\n\n              _context4.next = 3;\n              return Time.sleep(2500);\n\n            case 3:\n              _this3.setState({\n                isShow: false\n              });\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    _this3.scrollToAnchor = function (index) {\n      return function () {\n        var anchor = document.getElementById(index);\n        anchor && anchor.scrollIntoView({\n          inline: 'start',\n          behavior: 'smooth'\n        });\n      };\n    };\n\n    _this3.down = function (e) {\n      if (!_this3.state.isShow) return;\n      isDrag = true;\n      currentY = e.pageY;\n    };\n\n    _this3.move = function (e) {\n      if (!isDrag) return;\n      var step = e.pageY - currentY,\n          top = _this3.state.top,\n          clientHeight = _this3.content.current.clientHeight;\n      top += step;\n      if (top < 100) top = 100;\n      if (top > window.innerHeight - clientHeight) top = window.innerHeight - clientHeight;\n\n      _this3.setState({\n        top: top\n      });\n\n      currentY = e.pageY;\n    };\n\n    _this3.up = function (e) {\n      isDrag = false;\n      currentY = e.pageY;\n    };\n\n    _this3.leave = function () {\n      isDrag = false;\n\n      _this3.setState({\n        isShow: false\n      });\n    };\n\n    _this3.state = {\n      array: new Array(_this3.props.num).fill(0),\n      top: 100,\n      isShow: true\n    };\n    _this3.content = React.createRef();\n\n    setQuizNavigator = function setQuizNavigator(index, value) {\n      var array = _this3.state.array;\n      array[index] = value;\n\n      _this3.setState({\n        array: array\n      });\n    };\n\n    getQuizUndo = function getQuizUndo() {\n      var undo = _this3.state.array.reduce(function (acc, vec) {\n        return acc + (vec < 1 ? 1 : 0);\n      }, 0);\n\n      if (!undo) return React.createElement(React.Fragment, null);else return React.createElement(\"p\", {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"\\u8FD8\\u6709\", undo, \"\\u9053\\u9898\\u6CA1\\u6709\\u4F5C\\u7B54\\uFF01\");\n    };\n\n    return _this3;\n  }\n\n  _createClass(QuizNavigator, [{\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$state = this.state,\n          array = _this$state.array,\n          isShow = _this$state.isShow;\n\n      var style = function style(value) {\n        return {\n          'backgroundColor': value ? 'blue' : 'white',\n          'color': value ? 'white' : 'rgb(176, 196, 224)'\n        };\n      };\n\n      var toggle_bn = {\n        transform: \"scaleX(\".concat(isShow ? 1 : -1, \")\")\n      };\n      var toggle_style = {\n        transform: \"translateX(\".concat(isShow ? 0 : this.content.current.clientWidth, \"px)\")\n      };\n      var content_config = {\n        className: 'exam-navigator-content pointer',\n        onMouseDown: this.down,\n        onMouseUp: this.up,\n        onMouseMove: this.move,\n        onMouseLeave: this.leave,\n        style: {\n          top: \"\".concat(this.state.top, \"px\")\n        }\n      };\n      return React.createElement(\"div\", Object.assign({}, content_config, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: toggle_style,\n        onMouseEnter: function onMouseEnter() {\n          return _this4.setState({\n            isShow: true\n          });\n        },\n        onClick: function onClick() {\n          return _this4.setState({\n            isShow: !isShow\n          });\n        },\n        ref: this.tab,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: toggle_bn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, \">\")), React.createElement(\"div\", {\n        style: toggle_style,\n        ref: this.content,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, array.map(function (value, index) {\n        return React.createElement(\"span\", {\n          key: 'exam-navigator-' + index,\n          className: \"exam-navigator-bn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        }, React.createElement(\"a\", {\n          style: style(value),\n          onClick: _this4.scrollToAnchor(index + 1),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 214\n          },\n          __self: this\n        }, index + 1), (index + 1) % 10 ? '' : React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }));\n      })), React.createElement(\"div\", {\n        style: {\n          marginTop: '10px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, \"\\u9898\\u6570: \", array.reduce(function (acc, val) {\n        return acc += val ? 1 : 0;\n      }), \"/\", this.props.num), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"\\u5269\\u4F59\\u65F6\\u95F4: \", React.createElement(Timer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, \"\\u8003\\u8BD5\\u65F6\\u9650: \", this.props.duration, \"min\"))));\n    }\n  }]);\n\n  return QuizNavigator;\n}(React.Component)) || _class2;\n\nvar Quiz = observer(_class4 =\n/*#__PURE__*/\nfunction (_React$Component3) {\n  _inherits(Quiz, _React$Component3);\n\n  function Quiz() {\n    var _getPrototypeOf2;\n\n    var _this5;\n\n    _classCallCheck(this, Quiz);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this5 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Quiz)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this5.copy = function (event) {\n      var text = document.getSelection().toString();\n      event.clipboardData.setData('text/plain', \"\".concat(text));\n      event.preventDefault();\n    };\n\n    return _this5;\n  }\n\n  _createClass(Quiz, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          index = _this$props.index,\n          quiz = _this$props.quiz;\n      var topic = quiz.topic,\n          type = quiz.type;\n      var items,\n          func,\n          origin = ['A', 'B', 'C'];\n\n      if (type == 'sc') {\n        origin.push('D');\n        type = 'radio';\n\n        func = function func(char) {\n          return function () {\n            quiz.stu_answer = char;\n            quiz.time_stamp = new Date().getTime();\n            setQuizNavigator(index, 1);\n          };\n        };\n      } else {\n        ['D', 'E', 'F'].forEach(function (char) {\n          return quiz[\"obj\".concat(char)] && quiz[\"obj\".concat(char)] != '' && origin.push(char);\n        });\n        type = 'checkbox';\n        quiz.stu_answer = [];\n\n        func = function func(char) {\n          return function () {\n            var answer_set = new Set(quiz.stu_answer);\n            var value = answer_set.has(char);\n            quiz.time_stamp = new Date().getTime();\n            if (value) answer_set.delete(char);else answer_set.add(char);\n            quiz.stu_answer = _toConsumableArray(answer_set).sort();\n            setQuizNavigator(index, answer_set.size > 0);\n          };\n        };\n      }\n\n      items = origin.map(function (char) {\n        return React.createElement(\"div\", {\n          className: \"exam-item\",\n          key: quiz.id + char,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"pointer\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: type,\n          name: quiz.id,\n          value: char,\n          onClick: func(char),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        }, quiz[\"obj\".concat(char)])));\n      });\n      return React.createElement(\"div\", {\n        className: \"exam-content-quiz\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        id: index + 2,\n        onCopy: this.copy,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }, index + 1, \".\", topic && topic.split('').map(function (t) {\n        return React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, t);\n      })), React.createElement(\"form\", {\n        name: quiz.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, items.sort(function () {\n        return Math.random() - .5;\n      })));\n    }\n  }]);\n\n  return Quiz;\n}(React.Component)) || _class4;\n\nvar Subjective = observer(_class6 =\n/*#__PURE__*/\nfunction (_React$Component4) {\n  _inherits(Subjective, _React$Component4);\n\n  function Subjective() {\n    var _getPrototypeOf3;\n\n    var _this6;\n\n    _classCallCheck(this, Subjective);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this6 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(Subjective)).call.apply(_getPrototypeOf3, [this].concat(args)));\n\n    _this6.handleChange = function (e) {\n      var quiz = _this6.props.quiz;\n      quiz.stu_answer = e.target.value.trim();\n    };\n\n    _this6.handlePaste = function (e) {\n      e.preventDefault();\n      window.showToast('不能粘贴哦');\n    };\n\n    return _this6;\n  }\n\n  _createClass(Subjective, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          index = _this$props2.index,\n          quiz = _this$props2.quiz;\n      var topic = quiz.topic;\n      return React.createElement(\"div\", {\n        className: \"exam-content-sub\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        id: index + 2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, index + 1, \".\", topic), React.createElement(\"textarea\", {\n        className: \"exam-sub-textarea\",\n        rows: \"10\",\n        onChange: this.handleChange,\n        onPaste: this.handlePaste,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Subjective;\n}(React.Component)) || _class6;\n\nvar previewGuide = React.createElement(\"div\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 316\n  },\n  __self: this\n}, React.createElement(\"h2\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 317\n  },\n  __self: this\n}, \"\\u8BD5\\u5377\\u9884\\u89C8\\u5BFC\\u5F15\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 318\n  },\n  __self: this\n}, \"\\u9884\\u89C8\\u8BD5\\u5377\\u968F\\u673A\\u51FA\\u9898\\u968F\\u673A\\u6392\\u5E8F\\u6548\\u679C\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 319\n  },\n  __self: this\n}, \"\\u4F53\\u9A8C\\u5B66\\u751F\\u7684\\u505A\\u9898\\u8FC7\\u7A0B\\u53CA\\u611F\\u53D7\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 320\n  },\n  __self: this\n}, \"\\u82E5\\u6EE1\\u610F\\u9884\\u89C8\\u6548\\u679C\\uFF0C\\u53EF\\u70B9\\u51FB\\u5377\\u5C3E\\u6309\\u94AE\\u7ACB\\u523B\\u53D1\\u5E03\\u8BD5\\u5377\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 321\n  },\n  __self: this\n}, \"\\u82E5\\u8981\\u7EE7\\u7EED\\u7F16\\u8F91\\u8BD5\\u5377\\uFF0C\\u53EF\\u70B9\\u51FB\\u5377\\u5C3E\\u6309\\u94AE\\u8FD4\\u56DE\\u7F16\\u8F91\\u9875\\u9762\"));\nvar promptOFF;\n\nvar Exam = observer(_class8 =\n/*#__PURE__*/\nfunction (_React$Component5) {\n  _inherits(Exam, _React$Component5);\n\n  function Exam(props) {\n    var _this7;\n\n    _classCallCheck(this, Exam);\n\n    _this7 = _possibleConstructorReturn(this, _getPrototypeOf(Exam).call(this, props));\n\n    _this7.abandon = function () {\n      if (Store.state.status === 'college') {\n        window.navigateBack();\n        return;\n      }\n\n      window.showModal({\n        view: React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 349\n          },\n          __self: this\n        }, \"\\u786E\\u8BA4\\u653E\\u5F03\\u8003\\u8BD5?\"),\n        onConfirm: function () {\n          var _onConfirm = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee5() {\n            return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n              while (1) {\n                switch (_context5.prev = _context5.next) {\n                  case 0:\n                    _this7.setState({\n                      prompt_on: false\n                    });\n\n                    window.showToast('已放弃考试！欢迎再战！', 1500, function () {\n                      return window.navigateTo(Route.Student.route);\n                    });\n                    _context5.next = 4;\n                    return submitAnswer();\n\n                  case 4:\n                  case \"end\":\n                    return _context5.stop();\n                }\n              }\n            }, _callee5);\n          }));\n\n          function onConfirm() {\n            return _onConfirm.apply(this, arguments);\n          }\n\n          return onConfirm;\n        }()\n      });\n    };\n\n    _this7.submit = function () {\n      if (_this7.state.isCAPTCHA) {\n        // Store.state.status === 'student'\n        if (true) {\n          window.showModal({\n            view: React.createElement(React.Fragment, null, React.createElement(\"h2\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 364\n              },\n              __self: this\n            }, \"\\u786E\\u8BA4\\u63D0\\u4EA4\\u8BD5\\u5377?\"), getQuizUndo()),\n            onConfirm: function () {\n              var _onConfirm2 = _asyncToGenerator(\n              /*#__PURE__*/\n              _regeneratorRuntime.mark(function _callee6() {\n                return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                  while (1) {\n                    switch (_context6.prev = _context6.next) {\n                      case 0:\n                        _this7.setState({\n                          prompt_on: false\n                        });\n\n                        _context6.next = 3;\n                        return submitAnswer();\n\n                      case 3:\n                      case \"end\":\n                        return _context6.stop();\n                    }\n                  }\n                }, _callee6);\n              }));\n\n              function onConfirm() {\n                return _onConfirm2.apply(this, arguments);\n              }\n\n              return onConfirm;\n            }()\n          });\n        } else {\n          window.navigateTo(RouteConfig.SelStu.route);\n        }\n      } else {\n        window.showToast('请填写正确的验证信息', 1750);\n      }\n    };\n\n    _this7.rejected =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee7() {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _this7.setState({\n                prompt_on: false\n              });\n\n              _context7.next = 3;\n              return window.hideMask();\n\n            case 3:\n              window.navigateBack();\n              _context7.next = 6;\n              return window.showToast('已放弃本次考试');\n\n            case 6:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n    var _Store$infoList$exam_ = Store.infoList.exam_paper,\n        body = _Store$infoList$exam_.body,\n        subjective = _Store$infoList$exam_.subjective;\n    _this7.state = {\n      isCAPTCHA: false,\n      blur_on: false,\n      prompt_on: false,\n      face_on: true,\n      question: body.reduce(function (acc, val) {\n        return [].concat(_toConsumableArray(acc), _toConsumableArray(val.question));\n      }, []).shuffle(),\n      subjective: subjective.reduce(function (acc, val) {\n        return [].concat(_toConsumableArray(acc), _toConsumableArray(val.question));\n      }, []).shuffle()\n    };\n\n    promptOFF = function promptOFF(callback) {\n      return _this7.setState({\n        prompt_on: false\n      }, callback);\n    };\n\n    return _this7;\n  }\n\n  _createClass(Exam, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      switch (Store.state.status) {\n        case 'college':\n          window.showModal({\n            view: previewGuide\n          });\n          break;\n\n        case 'student':\n          this.setState({\n            prompt_on: true,\n            blur_on: true\n          });\n\n          window.onbeforeunload = function () {\n            return '离开页面将不会记录作答进度';\n          };\n\n          break;\n\n        default:\n          this.setState({\n            prompt_on: true,\n            blur_on: true\n          });\n\n          window.onbeforeunload = function () {\n            return '离开页面将不会记录作答进度';\n          };\n\n      }\n\n      this.setState({\n        face_on: true\n      });\n      Store.state.inExam = true;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.setState({\n        blur_on: false,\n        prompt_on: false\n      });\n\n      window.onbeforeunload = function () {};\n\n      Store.state.inExam = false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this8 = this;\n\n      var head = Store.infoList.exam_paper.head;\n      var question = this.state.question;\n      var subjective = this.state.subjective;\n      var status = Store.state.status !== 'college';\n      var submit_config = {\n        className: \"iw-bn iw-\".concat(this.state.isCAPTCHA ? 'confirm' : 'cancel'),\n        onClick: this.submit,\n        style: {\n          transition: 'all .6s'\n        }\n      };\n      return React.createElement(\"div\", {\n        className: \"exam-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421\n        },\n        __self: this\n      }, this.state.prompt_on && React.createElement(Prompt, {\n        message: \"\\u5C06\\u4E0D\\u4F1A\\u4FDD\\u7559\\u60A8\\u7684\\u4F5C\\u7B54\\u60C5\\u51B5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 422\n        },\n        __self: this\n      }), React.createElement(QuizNavigator, {\n        num: head.num,\n        duration: head.duration,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"exam-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        id: 1,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 426\n        },\n        __self: this\n      }, head.title), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 427\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row aside\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, \"\\u9898\\u76EE\\u6570\\u91CF:\", head.num), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430\n        },\n        __self: this\n      }, \"\\u8003\\u8BD5\\u5F00\\u59CB\\u65F6\\u95F4:\", new Date().toLocaleString(), \";\\u7B54\\u9898\\u65F6\\u9650:\", head.duration, \"min\"))), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, question.map(function (quiz, index) {\n        return React.createElement(Quiz, {\n          key: \"quiz-\".concat(index),\n          quiz: quiz,\n          index: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 435\n          },\n          __self: this\n        });\n      }), subjective.map(function (quiz, index) {\n        return React.createElement(Subjective, {\n          key: \"sub-\".concat(index),\n          quiz: quiz,\n          index: question.length + index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 438\n          },\n          __self: this\n        });\n      }))), React.createElement(\"div\", {\n        className: \"exam-submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 442\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"pointer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 443\n        },\n        __self: this\n      }, React.createElement(MathCAPTCHA, {\n        onCorrect: function onCorrect() {\n          return _this8.setState({\n            isCAPTCHA: true\n          });\n        },\n        seed: 233,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"row center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 447\n        },\n        __self: this\n      }, React.createElement(\"span\", Object.assign({}, submit_config, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }), status ? '提交考试' : '发布试卷'), React.createElement(\"span\", {\n        className: \"responsive iw-bn iw-cancel\",\n        onClick: this.abandon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449\n        },\n        __self: this\n      }, status ? '放弃考试' : '返回')))));\n    }\n  }]);\n\n  return Exam;\n}(React.Component)) || _class8;\n\nexport default Exam;","map":{"version":3,"sources":["C:\\Users\\sunli\\Documents\\GitHub\\Theory-Exam\\code\\client\\src\\pages\\Exam\\Exam.jsx"],"names":["React","observer","Prompt","StaticRouter","Time","MathCAPTCHA","Route","Store","RouteConfig","cookieManage","setQuizNavigator","getQuizUndo","isDrag","currentY","buildTimeCount","milliseconds","second","Math","floor","hour","minute","mill","substr","submitAnswer","window","showLoading","showToast","request","func","hideLoading","result","infoList","exam_paper","submit","deleteStoreCookie","storeCookie","showModal","view","toString","Timer","props","state","time","head","setState","sleep","duration","foo","step","setInterval","map","ele","join","clearInterval","interval","onConfirm","promptOFF","confirmText","cancelText","onCancel","navigateBack","navigateTo","Student","route","Component","QuizNavigator","componentWillMount","array","Array","num","fill","componentDidMount","isShow","scrollToAnchor","index","anchor","document","getElementById","scrollIntoView","inline","behavior","down","e","pageY","move","top","clientHeight","content","current","innerHeight","up","leave","createRef","value","undo","reduce","acc","vec","color","style","toggle_bn","transform","toggle_style","clientWidth","content_config","className","onMouseDown","onMouseUp","onMouseMove","onMouseLeave","tab","marginTop","val","Quiz","copy","event","text","getSelection","clipboardData","setData","preventDefault","quiz","topic","type","items","origin","push","char","stu_answer","time_stamp","Date","getTime","forEach","answer_set","Set","has","delete","add","sort","size","id","split","t","random","Subjective","handleChange","target","trim","handlePaste","previewGuide","Exam","abandon","status","prompt_on","isCAPTCHA","SelStu","rejected","hideMask","body","subjective","blur_on","face_on","question","shuffle","callback","onbeforeunload","inExam","submit_config","onClick","transition","title","toLocaleString","length"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { observer } from 'mobx-react'\r\nimport { Prompt, StaticRouter } from 'react-router'\r\n\r\nimport Time from '../../utils/Time'\r\nimport MathCAPTCHA from '../../utils/MathCAPTCHA/MathCAPTCHA'\r\nimport Route from '../../config/RouteConfig'\r\n\r\nimport Store from '../../utils/Store'\r\n\r\nimport './Exam.css'\r\nimport RouteConfig from '../../config/RouteConfig'\r\n\r\nimport cookieManage from '../../utils/cookieManage'\r\n\r\n\r\n\r\nlet setQuizNavigator, getQuizUndo\r\n\r\nlet isDrag = false\r\nlet currentY = 0\r\n\r\nconst buildTimeCount = (milliseconds) => {\r\n  let second = Math.floor((milliseconds % 60000 ) / 1000)\r\n  let hour = Math.floor(milliseconds / 3600000)\r\n  let minute = Math.floor((milliseconds % 3600000) / 60000)\r\n  let mill = milliseconds - 60000 * minute - 1000 * second - 3600000 * hour;\r\n  mill = ('' + mill).substr(0, 3)\r\n\r\n  return [hour, minute, second, mill]\r\n\r\n}\r\n\r\nexport const submitAnswer = async () => {\r\n  try {\r\n    await window.showLoading()\r\n    await window.showToast('提交答案中，请不要刷新.....', 1000)\r\n    let func = await Store.request('exam/submit')()\r\n    await func()\r\n  } catch(error) {\r\n    await window.hideLoading()\r\n    let result = Store.infoList.exam_paper.submit()\r\n    cookieManage.deleteStoreCookie()\r\n    cookieManage.storeCookie(result)\r\n    await window.showModal({\r\n      view:\r\n      <>\r\n        <h4>{error.toString()}</h4>\r\n        <p>请确保网络连接稳定，稍后再重新提交</p>\r\n        <p>已经将本次作答记录储存在本地，将会在下次您打开首页的时候自动为您提交</p>\r\n      </>\r\n    })\r\n  }\r\n}\r\n\r\n@observer\r\nclass Timer extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      time: Store.infoList.exam_paper.head\r\n    }\r\n  }\r\n  componentWillMount() {\r\n    this.setState({ time: 'launching……' })\r\n  }\r\n  async componentDidMount() {\r\n    await Time.sleep(3000)\r\n    let { duration } = Store.infoList.exam_paper.head\r\n    let foo = (duration, step) => {\r\n      return setInterval(() => {\r\n        let [hour, minute, second, mill] = buildTimeCount(duration)\r\n        this.setState({\r\n          time:  [hour, minute, second]\r\n                  .map(ele => ele < 10 ? '0' + ele : ele)\r\n                  .join(': ') + '.' + mill\r\n        })\r\n        hour === 0 && minute === 5 && second === 0 &&\r\n          window.showModal({\r\n            view:\r\n              <>\r\n                <h2>温馨提示</h2>\r\n                <p>考试时间不足5分钟</p>\r\n                <p>请注意！</p>\r\n              </>\r\n          })\r\n        if (duration <= 0) {\r\n          clearInterval(this.state.interval)\r\n          this.setState({ time: `time's up` })\r\n          let onConfirm = () => promptOFF(async () => {\r\n            await submitAnswer()\r\n            Store.infoList.exam_paper.head.duration = 5\r\n          })\r\n          window.showModal({\r\n            view: <h2>时间到！</h2>,\r\n            onConfirm,\r\n            confirmText: '立即交卷',\r\n            cancelText: '放弃本次考试',\r\n            onCancel: () => promptOFF(() => {\r\n              window.navigateBack()\r\n              window.showToast('已放弃考试！欢迎再战！', 1500, () => window.navigateTo(Route.Student.route))\r\n            })\r\n          })\r\n        }\r\n        duration -= step\r\n      }, step)\r\n    }\r\n    let interval = foo(duration * 60000, 50)\r\n    this.setState({ interval })\r\n  }\r\n  componentWillUnmount() {\r\n    clearInterval(this.state.interval)\r\n  }\r\n  render() {\r\n    return <span>{this.state.time}</span>\r\n  }\r\n}\r\n\r\n@observer\r\nclass QuizNavigator extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      array: new Array(this.props.num).fill(0),\r\n      top: 100,\r\n      isShow: true\r\n    }\r\n    this.content = React.createRef();\r\n    setQuizNavigator = (index, value) => {\r\n      let { array } = this.state\r\n      array[index] = value\r\n      this.setState({ array })\r\n    }\r\n    getQuizUndo = () => {\r\n      let undo = this.state.array.reduce((acc, vec) => acc + (vec < 1 ? 1 : 0), 0)\r\n      if (!undo)\r\n        return <></>\r\n      else\r\n        return <p style={{ color: 'red' }}>还有{undo}道题没有作答！</p>\r\n    }\r\n  }\r\n  componentWillMount = () => {\r\n    this.setState({ array: new Array(this.props.num).fill(0) })\r\n  }\r\n  componentDidMount = async () => {\r\n    this.setState({ isShow: true })\r\n    await Time.sleep(2500)\r\n    this.setState({ isShow: false })\r\n  }\r\n  scrollToAnchor = index =>\r\n    () => {\r\n      let anchor = document.getElementById(index)\r\n      anchor && anchor.scrollIntoView({ inline: 'start', behavior: 'smooth' })\r\n    }\r\n  down = e => {\r\n    if (!this.state.isShow)\r\n      return\r\n    isDrag = true\r\n    currentY = e.pageY\r\n  }\r\n  move = e => {\r\n    if (!isDrag)\r\n      return\r\n    let step = e.pageY - currentY, { top } = this.state, { clientHeight } = this.content.current\r\n    top += step\r\n    if (top < 100)\r\n      top = 100\r\n    if (top > window.innerHeight - clientHeight)\r\n      top = window.innerHeight - clientHeight\r\n    this.setState({ top })\r\n    currentY = e.pageY\r\n  }\r\n  up = e => {\r\n    isDrag = false\r\n    currentY = e.pageY\r\n  }\r\n  leave = () => {\r\n    isDrag = false\r\n    this.setState({ isShow: false })\r\n  }\r\n  render() {\r\n    let { array, isShow } = this.state\r\n    const style = value =>\r\n      ({\r\n        'backgroundColor': value ? 'blue' : 'white',\r\n        'color': value ? 'white' : 'rgb(176, 196, 224)'\r\n      })\r\n    const toggle_bn = {\r\n      transform: `scaleX(${isShow ? 1 : -1})`,\r\n    }\r\n    const toggle_style = {\r\n      transform: `translateX(${isShow ? 0 : this.content.current.clientWidth}px)`,\r\n    }\r\n    const content_config = {\r\n      className: 'exam-navigator-content pointer',\r\n      onMouseDown: this.down,\r\n      onMouseUp: this.up,\r\n      onMouseMove: this.move,\r\n      onMouseLeave: this.leave,\r\n      style: {\r\n        top: `${this.state.top}px`\r\n      },\r\n    }\r\n    return (\r\n      <div {...content_config}>\r\n        <div style={toggle_style} onMouseEnter={() => this.setState({ isShow: true })} onClick={() => this.setState({ isShow: !isShow })} ref={this.tab}>\r\n          <div style={toggle_bn}>></div>\r\n        </div>\r\n        <div style={toggle_style} ref={this.content}>\r\n          <div>\r\n            {\r\n              array.map((value, index) =>\r\n                <span key={'exam-navigator-' + index} className='exam-navigator-bn'>\r\n                  <a style={style(value)} onClick={this.scrollToAnchor(index + 1)}>{index + 1}</a>\r\n                  {(index + 1) % 10 ? '' : <br />}\r\n                </span>\r\n              )\r\n            }\r\n          </div>\r\n          <div style={{ marginTop: '10px' }}>\r\n            <div>题数: {array.reduce((acc, val) => acc += val ? 1 : 0)}/{this.props.num}</div>\r\n            <div>剩余时间: <Timer /></div>\r\n            <div>考试时限: {this.props.duration}min</div>\r\n          </div>\r\n        </div>\r\n      </div >\r\n    )\r\n  }\r\n}\r\n\r\n@observer\r\nclass Quiz extends React.Component {\r\n  copy = event => {\r\n    let text = document.getSelection().toString()\r\n    event.clipboardData.setData('text/plain',\r\n      `${text}`)\r\n    event.preventDefault()\r\n  }\r\n  render() {\r\n    let { index, quiz } = this.props\r\n    let { topic, type } = quiz\r\n    let items, func, origin = ['A', 'B', 'C']\r\n    if (type == 'sc') {\r\n      origin.push('D')\r\n      type = 'radio'\r\n      func = char => () => {\r\n        quiz.stu_answer = char\r\n        quiz.time_stamp = new Date().getTime()\r\n        setQuizNavigator(index, 1)\r\n      }\r\n    } else {\r\n      ['D', 'E', 'F'].forEach(char => quiz[`obj${char}`] && quiz[`obj${char}`] != '' && origin.push(char))\r\n      type = 'checkbox'\r\n      quiz.stu_answer = []\r\n      func = char => () => {\r\n        const answer_set = new Set(quiz.stu_answer)\r\n        let value = answer_set.has(char)\r\n        quiz.time_stamp = new Date().getTime()\r\n        if (value)\r\n          answer_set.delete(char)\r\n        else\r\n          answer_set.add(char)\r\n        quiz.stu_answer = [...answer_set].sort()\r\n        setQuizNavigator(index, answer_set.size > 0)\r\n      }\r\n    }\r\n    items = origin.map(char =>\r\n      <div className='exam-item' key={quiz.id + char}>\r\n        <label className='pointer'>\r\n          <input type={type} name={quiz.id} value={char} onClick={func(char)} />\r\n          <span>{quiz[`obj${char}`]}</span>\r\n        </label>\r\n      </div>\r\n    )\r\n    return (\r\n      <div className='exam-content-quiz'>\r\n        <p id={index + 2} onCopy={this.copy}>{index + 1}.{topic && topic.split('').map(t => <span>{t}</span>)}</p>\r\n        <form name={quiz.id}>{items.sort(() => Math.random() - .5)}</form>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n@observer\r\nclass Subjective extends React.Component {\r\n    handleChange = (e) => {\r\n        let { quiz } = this.props\r\n        quiz.stu_answer = e.target.value.trim()\r\n    }\r\n\r\n    handlePaste = (e) => {\r\n        e.preventDefault()\r\n        window.showToast('不能粘贴哦')\r\n    }\r\n\r\n    render() {\r\n        let { index, quiz } = this.props\r\n        let { topic } = quiz\r\n        return (\r\n            <div className='exam-content-sub'>\r\n              <p id={index + 2}>{index + 1}.{ topic }</p>\r\n              <textarea\r\n                className='exam-sub-textarea'\r\n                rows='10'\r\n                onChange={ this.handleChange }\r\n                onPaste= { this.handlePaste }\r\n              >\r\n\r\n              </textarea>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst previewGuide = (\r\n  <div>\r\n    <h2>试卷预览导引</h2>\r\n    <p>预览试卷随机出题随机排序效果</p>\r\n    <p>体验学生的做题过程及感受</p>\r\n    <p>若满意预览效果，可点击卷尾按钮立刻发布试卷</p>\r\n    <p>若要继续编辑试卷，可点击卷尾按钮返回编辑页面</p>\r\n  </div>\r\n)\r\n\r\nlet promptOFF\r\n\r\n@observer\r\nclass Exam extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    const { body, subjective } = Store.infoList.exam_paper\r\n    this.state = {\r\n      isCAPTCHA: false,\r\n      blur_on: false,\r\n      prompt_on: false,\r\n      face_on: true,\r\n      question: body.reduce((acc, val) => [...acc, ...val.question], []).shuffle(),\r\n      subjective: subjective.reduce((acc, val) => [...acc, ...val.question], []).shuffle()\r\n    }\r\n    promptOFF = callback => this.setState({ prompt_on: false }, callback)\r\n\r\n  }\r\n  abandon = () => {\r\n    if (Store.state.status === 'college') {\r\n      window.navigateBack()\r\n      return\r\n    }\r\n    window.showModal({\r\n      view: <h2>确认放弃考试?</h2>,\r\n      onConfirm: async () => {\r\n        this.setState({ prompt_on: false })\r\n        window.showToast('已放弃考试！欢迎再战！', 1500, () => window.navigateTo(Route.Student.route))\r\n        await submitAnswer()\r\n      }\r\n    })\r\n  }\r\n  submit = () => {\r\n    if (this.state.isCAPTCHA) {\r\n      // Store.state.status === 'student'\r\n      if (true) {\r\n        window.showModal({\r\n          view:\r\n            <>\r\n              <h2>确认提交试卷?</h2>\r\n              {getQuizUndo()}\r\n            </>\r\n          ,\r\n          onConfirm: async () => {\r\n            this.setState({ prompt_on: false })\r\n            await submitAnswer()\r\n\r\n          }\r\n        })\r\n      } else {\r\n        window.navigateTo(RouteConfig.SelStu.route)\r\n      }\r\n    } else {\r\n      window.showToast('请填写正确的验证信息', 1750)\r\n    }\r\n  }\r\n  rejected = async () => {\r\n    this.setState({ prompt_on: false })\r\n    await window.hideMask()\r\n    window.navigateBack()\r\n    await window.showToast('已放弃本次考试')\r\n  }\r\n  componentWillMount() {\r\n    switch (Store.state.status) {\r\n      case 'college':\r\n        window.showModal({ view: previewGuide })\r\n        break\r\n      case 'student':\r\n        this.setState({ prompt_on: true, blur_on: true })\r\n        window.onbeforeunload = () => '离开页面将不会记录作答进度'\r\n        break\r\n      default:\r\n        this.setState({ prompt_on: true, blur_on: true })\r\n        window.onbeforeunload = () => '离开页面将不会记录作答进度'\r\n    }\r\n    this.setState({ face_on: true })\r\n    Store.state.inExam = true\r\n  }\r\n  componentWillUnmount() {\r\n    this.setState({ blur_on: false, prompt_on: false })\r\n    window.onbeforeunload = () => { }\r\n        Store.state.inExam = false\r\n    }\r\n  render() {\r\n    const { head } = Store.infoList.exam_paper\r\n    let question = this.state.question\r\n    let subjective = this.state.subjective\r\n    let status = Store.state.status !== 'college'\r\n    let submit_config = {\r\n      className: `iw-bn iw-${this.state.isCAPTCHA ? 'confirm' : 'cancel'}`,\r\n      onClick: this.submit,\r\n      style: {\r\n        transition: 'all .6s'\r\n      }\r\n    }\r\n    return (\r\n      <div className='exam-container'>\r\n        {this.state.prompt_on && <Prompt message='将不会保留您的作答情况' />}\r\n        <QuizNavigator num={head.num} duration={head.duration} />\r\n        <div className='exam-content'>\r\n          <div>\r\n            <h2 id={1}>{head.title}</h2>\r\n            <hr />\r\n            <div className='row aside'>\r\n              <span>题目数量:{head.num}</span>\r\n              <span>考试开始时间:{new Date().toLocaleString()};答题时限:{head.duration}min</span>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            {\r\n              question.map((quiz, index) => <Quiz key={`quiz-${index}`} quiz={quiz} index={index} />)\r\n            }\r\n            {\r\n              subjective.map((quiz, index) => <Subjective key={`sub-${index}`} quiz={quiz} index={question.length + index} />)\r\n            }\r\n          </div>\r\n        </div>\r\n        <div className='exam-submit'>\r\n          <div className='pointer'>\r\n            <MathCAPTCHA onCorrect={() => this.setState({ isCAPTCHA: true })} seed={233} />\r\n          </div>\r\n          <div className='row center'>\r\n            <p>\r\n              <span {...submit_config}>{status ? '提交考试' : '发布试卷'}</span>\r\n              <span className='responsive iw-bn iw-cancel' onClick={this.abandon}>{status ? '放弃考试' : '返回'}</span>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Exam\r\n"]},"metadata":{},"sourceType":"module"}