{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\src\\\\api\\\\exam\\\\submit.js\";\nimport { post } from '../../utils/request';\nimport cookieManage from '../../utils/cookieManage';\nimport React from 'react';\nexport default\n/*#__PURE__*/\n(function () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(store) {\n    var submitFunc, result, res;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            submitFunc = store.infoList.exam_paper.submit;\n\n            if (typeof submitFunc === 'function') {\n              result = store.infoList.exam_paper.submit();\n            } else {\n              result = cookieManage.getStoreCookie();\n            }\n\n            _context3.prev = 2;\n            _context3.next = 5;\n            return post('api/student/test/score/v1', result);\n\n          case 5:\n            res = _context3.sent;\n            _context3.next = 17;\n            break;\n\n          case 8:\n            _context3.prev = 8;\n            _context3.t0 = _context3[\"catch\"](2);\n            cookieManage.deleteStoreCookie();\n            cookieManage.storeCookie(result);\n            _context3.t1 = window.iwType() === 'loading';\n\n            if (!_context3.t1) {\n              _context3.next = 16;\n              break;\n            }\n\n            _context3.next = 16;\n            return window.hideLoading();\n\n          case 16:\n            return _context3.abrupt(\"return\",\n            /*#__PURE__*/\n            _asyncToGenerator(\n            /*#__PURE__*/\n            _regeneratorRuntime.mark(function _callee() {\n              return _regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      _context.next = 2;\n                      return window.showModal({\n                        view: React.createElement(React.Fragment, null, React.createElement(\"h4\", {\n                          __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 24\n                          },\n                          __self: this\n                        }, _context3.t0.toString()), React.createElement(\"p\", {\n                          __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 25\n                          },\n                          __self: this\n                        }, \"\\u8BF7\\u786E\\u4FDD\\u7F51\\u7EDC\\u8FDE\\u63A5\\u7A33\\u5B9A\\uFF0C\\u7A0D\\u540E\\u518D\\u91CD\\u65B0\\u63D0\\u4EA4\"), React.createElement(\"p\", {\n                          __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 26\n                          },\n                          __self: this\n                        }, \"\\u5DF2\\u7ECF\\u5C06\\u672C\\u6B21\\u4F5C\\u7B54\\u8BB0\\u5F55\\u50A8\\u5B58\\u5728\\u672C\\u5730\\uFF0C\\u5C06\\u4F1A\\u5728\\u4E0B\\u6B21\\u60A8\\u6253\\u5F00\\u9996\\u9875\\u7684\\u65F6\\u5019\\u81EA\\u52A8\\u4E3A\\u60A8\\u63D0\\u4EA4\"))\n                      });\n\n                    case 2:\n                      return _context.abrupt(\"return\", _context.sent);\n\n                    case 3:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, _callee, this);\n            })));\n\n          case 17:\n            return _context3.abrupt(\"return\",\n            /*#__PURE__*/\n            _asyncToGenerator(\n            /*#__PURE__*/\n            _regeneratorRuntime.mark(function _callee2() {\n              return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      cookieManage.deleteStoreCookie();\n                      _context2.t0 = window.iwType() === 'loading';\n\n                      if (!_context2.t0) {\n                        _context2.next = 5;\n                        break;\n                      }\n\n                      _context2.next = 5;\n                      return window.hideLoading();\n\n                    case 5:\n                      _context2.next = 7;\n                      return window.showModal({\n                        view: React.createElement(\"h3\", {\n                          __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 35\n                          },\n                          __self: this\n                        }, \"\\u5F97\\u5206:\", res.data),\n                        onConfirm: function onConfirm() {\n                          return window.navigateTo('/student');\n                        },\n                        onCancel: function onCancel() {\n                          return window.navigateTo('/student');\n                        }\n                      });\n\n                    case 7:\n                      return _context2.abrupt(\"return\", _context2.sent);\n\n                    case 8:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2, this);\n            })));\n\n          case 18:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[2, 8]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n})();","map":{"version":3,"sources":["C:\\Users\\sunli\\Documents\\GitHub\\Theory-Exam\\code\\client\\src\\api\\exam\\submit.js"],"names":["post","cookieManage","React","store","submitFunc","infoList","exam_paper","submit","result","getStoreCookie","res","deleteStoreCookie","storeCookie","window","iwType","hideLoading","showModal","view","toString","data","onConfirm","navigateTo","onCancel"],"mappings":";;;AAAA,SAASA,IAAT,QAAqB,qBAArB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAe,kBAAMC,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAETC,YAAAA,UAFS,GAEID,KAAK,CAACE,QAAN,CAAeC,UAAf,CAA0BC,MAF9B;;AAIb,gBAAI,OAAOH,UAAP,KAAsB,UAA1B,EAAsC;AACpCI,cAAAA,MAAM,GAAGL,KAAK,CAACE,QAAN,CAAeC,UAAf,CAA0BC,MAA1B,EAAT;AACD,aAFD,MAEO;AACLC,cAAAA,MAAM,GAAGP,YAAY,CAACQ,cAAb,EAAT;AACD;;AARY;AAAA;AAAA,mBAUKT,IAAI,CAAC,2BAAD,EAA8BQ,MAA9B,CAVT;;AAAA;AAUPE,YAAAA,GAVO;AAAA;AAAA;;AAAA;AAAA;AAAA;AAYXT,YAAAA,YAAY,CAACU,iBAAb;AACAV,YAAAA,YAAY,CAACW,WAAb,CAAyBJ,MAAzB;AAbW,2BAcXK,MAAM,CAACC,MAAP,OAAoB,SAdT;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAc4BD,MAAM,CAACE,WAAP,EAd5B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAeJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAkBF,MAAM,CAACG,SAAP,CAAiB;AACxCC,wBAAAA,IAAI,EACJ,0CACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAK,aAAMC,QAAN,EAAL,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oIAFF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0OAHF;AAFwC,uBAAjB,CAAlB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAfI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAyBN;AAAA;AAAA;AAAA;AAAA;AACLjB,sBAAAA,YAAY,CAACU,iBAAb;AADK,qCAELE,MAAM,CAACC,MAAP,OAAoB,SAFf;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,6BAEkCD,MAAM,CAACE,WAAP,EAFlC;;AAAA;AAAA;AAAA,6BAGQF,MAAM,CAACG,SAAP,CAAiB;AAC5BC,wBAAAA,IAAI,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAAQP,GAAG,CAACS,IAAZ,CADsB;AAE5BC,wBAAAA,SAAS,EAAE;AAAA,iCAAMP,MAAM,CAACQ,UAAP,CAAkB,UAAlB,CAAN;AAAA,yBAFiB;AAG5BC,wBAAAA,QAAQ,EAAE;AAAA,iCAAMT,MAAM,CAACQ,UAAP,CAAkB,UAAlB,CAAN;AAAA;AAHkB,uBAAjB,CAHR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAzBM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import { post } from '../../utils/request'\r\nimport cookieManage from '../../utils/cookieManage'\r\nimport React from 'react'\r\n\r\n\r\nexport default async store => {\r\n\r\n  let submitFunc = store.infoList.exam_paper.submit\r\n  let result\r\n  if (typeof submitFunc === 'function') {\r\n    result = store.infoList.exam_paper.submit()\r\n  } else {\r\n    result = cookieManage.getStoreCookie()\r\n  }\r\n  try {\r\n    var res = await post('api/student/test/score/v1', result)\r\n  } catch(error) {\r\n    cookieManage.deleteStoreCookie()\r\n    cookieManage.storeCookie(result)\r\n    window.iwType() === 'loading' && await window.hideLoading()\r\n    return async () => await window.showModal({\r\n      view:\r\n      <>\r\n        <h4>{error.toString()}</h4>\r\n        <p>请确保网络连接稳定，稍后再重新提交</p>\r\n        <p>已经将本次作答记录储存在本地，将会在下次您打开首页的时候自动为您提交</p>\r\n      </>\r\n    })\r\n  }\r\n\r\n  return async () => {\r\n    cookieManage.deleteStoreCookie()\r\n    window.iwType() === 'loading' && await window.hideLoading()\r\n    return await window.showModal({\r\n      view: <h3>得分:{res.data}</h3>,\r\n      onConfirm: () => window.navigateTo('/student'),\r\n      onCancel: () => window.navigateTo('/student')\r\n    })\r\n  }\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}