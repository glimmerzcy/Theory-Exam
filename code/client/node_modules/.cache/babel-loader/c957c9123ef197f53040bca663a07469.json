{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\n\nvar _class,\n    _jsxFileName = \"C:\\\\Users\\\\sunli\\\\Documents\\\\GitHub\\\\Theory-Exam\\\\code\\\\client\\\\src\\\\components\\\\EditCard.jsx\",\n    _class2;\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport './EditCard.css';\n\nvar Item = observer(_class =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Item, _React$Component);\n\n  function Item() {\n    _classCallCheck(this, Item);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Item).apply(this, arguments));\n  }\n\n  _createClass(Item, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          index = _this$props.index,\n          name = _this$props.name,\n          type = _this$props.type,\n          question = _this$props.question,\n          item = question.option(index),\n          items = question.options();\n\n      var onSel = function onSel() {\n        if (type === 'mc') {\n          item.value = !item.value;\n          return;\n        }\n\n        items.forEach(function (elem) {\n          return elem.value = false;\n        });\n        item.value = true;\n      };\n\n      if (type === 'sc' && index > 3) return React.createElement(React.Fragment, null);\n      return React.createElement(\"div\", {\n        className: \"ec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"pointer\",\n        name: name,\n        type: type === 'sc' ? 'radio' : 'checkbox',\n        value: index,\n        onChange: onSel,\n        checked: item.value ? 'checked' : '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 24\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25\n        },\n        __self: this\n      }, String.fromCharCode(65 + index)), React.createElement(\"input\", {\n        maxLength: \"60\",\n        placeholder: \"\\u5728\\u6B64\\u8F93\\u5165\\u9009\\u9879\",\n        className: \"input\",\n        value: item.text,\n        onChange: function onChange(e) {\n          return item.text = e.target.value;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26\n        },\n        __self: this\n      }), type === 'mc' && items.length > 3 && React.createElement(\"img\", {\n        className: \"pointer\",\n        title: \"\\u5220\\u9664\\u9009\\u9879\",\n        src: require('../assets/delete.png'),\n        onClick: function onClick() {\n          return question.remove(index);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Item;\n}(React.Component)) || _class;\n\nvar EditCard = observer(_class2 =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(EditCard, _React$Component2);\n\n  function EditCard(props) {\n    var _this;\n\n    _classCallCheck(this, EditCard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EditCard).call(this, props));\n\n    _this.shrink = function () {\n      var title_height = _this.state.title_height;\n      title_height = 0;\n\n      _this.setState({\n        title_height: title_height\n      }, _this.autoH);\n    };\n\n    _this.shrink_item = function () {\n      var item_height = _this.state.item_height;\n      item_height = 0;\n\n      _this.setState({\n        item_height: item_height\n      }, _this.autoH);\n    };\n\n    _this.textarea_input = function (e) {\n      var question = _this.props.question,\n          oldL = question.title.length,\n          newL = e.target.value.length;\n      question.setTitle(e);\n\n      if (newL < oldL) {\n        _this.shrink();\n\n        return;\n      }\n\n      _this.autoH();\n    };\n\n    _this.textarea_input_item = function (e) {\n      var question = _this.props.question,\n          oldL = question.item.length,\n          newL = e.target.value.length;\n      question.setItem(e);\n\n      if (newL < oldL) {\n        _this.shrink();\n\n        return;\n      }\n\n      _this.autoH();\n    };\n\n    _this.autoH = function () {\n      var _this$state = _this.state,\n          title_height = _this$state.title_height,\n          textarea_ref = _this$state.textarea_ref,\n          current = textarea_ref.current;\n      if (title_height < current.scrollHeight) _this.setState({\n        title_height: current.scrollHeight + 3\n      });\n    };\n\n    _this.rpl = function (e) {\n      var char = e.which || e.keyCode;\n      char === 13 && e.preventDefault();\n    };\n\n    _this.state = {\n      title_height: 0,\n      textarea_ref: React.createRef(),\n      item_height: 0,\n      textarea_ref_item: React.createRef()\n    };\n    return _this;\n  }\n\n  _createClass(EditCard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.autoH();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          question = _this$props2.question,\n          section = _this$props2.section,\n          id = _this$props2.id,\n          type = section.config.type,\n          keyo = \"\".concat(question, \"-\").concat(id),\n          _this$state2 = this.state,\n          textarea_ref = _this$state2.textarea_ref,\n          title_height = _this$state2.title_height,\n          textarea_ref_item = _this$state2.textarea_ref_item,\n          item_height = _this$state2.item_height,\n          ta_style = title_height > 0 ? {\n        height: \"\".concat(title_height, \"px\")\n      } : {},\n          xx_style = item_height > 0 ? {\n        height: \"\".concat(item_height, \"px\")\n      } : {};\n      return React.createElement(\"div\", {\n        className: \"ec-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ec-head row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, id + 1, \".\"), React.createElement(\"textarea\", {\n        ref: textarea_ref,\n        style: ta_style,\n        placeholder: \"\\u5728\\u6B64\\u8F93\\u5165\\u9898\\u5E72\",\n        onKeyPress: this.rpl,\n        onMouseOver: this.shrink,\n        onMouseEnter: this.autoH,\n        onChange: this.textarea_input,\n        value: question.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(\"img\", {\n        className: \"pointer\",\n        title: \"\\u5220\\u9664\\u672C\\u9898\\u76EE\",\n        src: require('../assets/rubbish.png'),\n        onClick: function onClick() {\n          return section.remove(id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"ec-items\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, type === 'sc' || type === 'mc' ? React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, question.options().map(function (item, i) {\n        return React.createElement(Item, {\n          key: keyo + '-' + i,\n          type: type,\n          question: question,\n          index: i,\n          name: keyo,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        });\n      })) : React.createElement(\"textarea\", {\n        ref: textarea_ref_item,\n        style: xx_style,\n        placeholder: \"\\u5728\\u6B64\\u8F93\\u5165\\u7B54\\u6848\",\n        onKeyPress: this.rpl,\n        onMouseOver: this.shrink_item,\n        onMouseEnter: this.autoH,\n        onChange: this.textarea_input_item,\n        value: question.item,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }), type === 'mc' && question.options().length < 6 && React.createElement(\"div\", {\n        className: \"ec-add-item pointer\",\n        title: \"\\u6DFB\\u52A0\\u4E00\\u4E2A\\u65B0\\u9009\\u9879\",\n        onClick: function onClick() {\n          return question.add();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, \"+\\u6DFB\\u52A0\\u9009\\u9879+\")));\n    }\n  }]);\n\n  return EditCard;\n}(React.Component)) || _class2;\n\nexport default EditCard;","map":{"version":3,"sources":["C:\\Users\\sunli\\Documents\\GitHub\\Theory-Exam\\code\\client\\src\\components\\EditCard.jsx"],"names":["React","observer","Item","props","index","name","type","question","item","option","items","options","onSel","value","forEach","elem","String","fromCharCode","text","e","target","length","require","remove","Component","EditCard","shrink","title_height","state","setState","autoH","shrink_item","item_height","textarea_input","oldL","title","newL","setTitle","textarea_input_item","setItem","textarea_ref","current","scrollHeight","rpl","char","which","keyCode","preventDefault","createRef","textarea_ref_item","section","id","config","keyo","ta_style","height","xx_style","map","i","add"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { observer } from 'mobx-react'\r\n\r\nimport './EditCard.css'\r\n\r\n@observer\r\nclass Item extends React.Component {\r\n  render() {\r\n    let { index, name, type, question } = this.props,\r\n      item = question.option(index),\r\n      items = question.options()\r\n    const onSel = () => {\r\n      if (type === 'mc') {\r\n        item.value = !item.value\r\n        return\r\n      }\r\n      items.forEach(elem => elem.value = false)\r\n      item.value = true\r\n    }\r\n    if (type === 'sc' && index > 3)\r\n      return <></>\r\n    return (\r\n      <div className='ec-item'>\r\n        <input className='pointer' name={name} type={type === 'sc' ? 'radio' : 'checkbox'} value={index} onChange={onSel} checked={item.value ? 'checked' : ''} />\r\n        <span>{String.fromCharCode(65 + index)}</span>\r\n        <input maxLength='60' placeholder='在此输入选项' className='input' value={item.text} onChange={e => item.text = e.target.value} />\r\n        {type === 'mc' && items.length > 3 && <img className='pointer' title='删除选项' src={require('../assets/delete.png')} onClick={() => question.remove(index)} />}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n@observer\r\nclass EditCard extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      title_height: 0,\r\n      textarea_ref: React.createRef(),\r\n      item_height: 0,\r\n      textarea_ref_item: React.createRef()\r\n    }\r\n  }\r\n  shrink = () => {\r\n    let { title_height } = this.state\r\n    title_height  = 0\r\n    this.setState({ title_height },  this.autoH)\r\n  }\r\n\r\n  shrink_item = () => {\r\n    let { item_height } = this.state\r\n    item_height  = 0\r\n    this.setState({ item_height },  this.autoH)\r\n  }\r\n  textarea_input = e => {\r\n    let { question } = this.props, oldL = question.title.length, newL = e.target.value.length\r\n    question.setTitle(e)\r\n    if (newL < oldL) {\r\n      this.shrink()\r\n      return\r\n    }\r\n    this.autoH()\r\n  }\r\n\r\n  textarea_input_item = e => {\r\n    let { question } = this.props, oldL = question.item.length, newL = e.target.value.length\r\n    question.setItem(e)\r\n    if (newL < oldL) {\r\n      this.shrink()\r\n      return\r\n    }\r\n    this.autoH()\r\n  }\r\n\r\n  autoH = () => {\r\n    let { title_height, textarea_ref } = this.state, { current } = textarea_ref\r\n    if (title_height < current.scrollHeight)\r\n      this.setState({ title_height: current.scrollHeight + 3 })\r\n  }\r\n  componentDidMount() {\r\n    this.autoH()\r\n  }\r\n  rpl = e => {\r\n    let char = e.which || e.keyCode\r\n    char === 13 && e.preventDefault()\r\n  }\r\n  render() {\r\n    let\r\n      { question, section, id } = this.props,\r\n      type = section.config.type,\r\n      keyo = `${question}-${id}`,\r\n      { textarea_ref, title_height, textarea_ref_item, item_height } = this.state,\r\n      ta_style = title_height > 0 ? { height: `${title_height}px` } : {},\r\n      xx_style = item_height > 0 ? { height: `${item_height}px` } : {}\r\n    return (\r\n      <div className='ec-content'>\r\n        <div className='ec-head row'>\r\n          <span>{id + 1}.</span>\r\n          <textarea ref={textarea_ref} style={ta_style} placeholder='在此输入题干' onKeyPress={this.rpl} onMouseOver={this.shrink}\r\n            onMouseEnter={this.autoH} onChange={this.textarea_input} value={question.title} />\r\n          <img className='pointer' title='删除本题目' src={require('../assets/rubbish.png')} onClick={() => section.remove(id)} />\r\n        </div>\r\n        <div className='ec-items'>\r\n            {\r\n                type === 'sc' || type === 'mc'\r\n                ?   <form>\r\n                        {question.options().map((item, i) => <Item key={keyo + '-' + i} type={type} question={question} index={i} name={keyo} />)}\r\n                    </form>\r\n                : <textarea ref={textarea_ref_item} style={xx_style} placeholder='在此输入答案' onKeyPress={this.rpl} onMouseOver={this.shrink_item}\r\n                onMouseEnter={this.autoH} onChange={this.textarea_input_item} value={question.item} />\r\n            }\r\n\r\n          {type === 'mc' && question.options().length < 6 && <div className='ec-add-item pointer' title='添加一个新选项' onClick={() => question.add()}>+添加选项+</div>}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nexport default EditCard\r\n"]},"metadata":{},"sourceType":"module"}